\documentclass[a4j,papersize,disablejfam,slide,14pt]{jsarticle}
\usepackage{graphicx,xcolor}
\usepackage{lastpage}
\usepackage{fancyhdr}
\renewcommand{\headrulewidth}{0.0pt}
\pagestyle{fancy}
\lhead{}
\chead{}
\rhead{}
\lfoot{}
\cfoot{\thepage{}/{}\pageref{LastPage}}
\rfoot{}
\usepackage[T1]{fontenc}
\usepackage{textcomp}
\usepackage[utf8]{inputenc}
\usepackage{bm}
\usepackage{comment}

\begin{comment}
 documentclass から17行はコピペ．意味はわからず．
 参考：
 	「何かを書き留める何か　LaTeX + jsarticle + slide でスライドを作る」
 	url: http://xaro.hatenablog.jp/entry/2013/09/26/004920
\end{comment}

\usepackage{amsmath}
\usepackage{latexsym} %qed
\usepackage{ascmac}
\usepackage{color}
\allowdisplaybreaks[1]
\newtheorem{Prop}{定理}
\newtheorem{Proof}{証明}
\def\qed{{\begin{flushright} (証明終) \end{flushright}}} %証明終了
\def\Vector#1{\mbox{\boldmath $#1$}} %ベクトルを太字表示
\def\Norm#1{\mbox{$\left\| #1 \right\|$}} %ノルム
\def\Det#1{\mbox{${\rm det} \left( #1 \right)$}} %行列式
\def\Diag#1{\mbox{${\rm diag} \left( #1 \right)$}} %行列の対角成分
\def\Exp#1{\mbox{${\rm E} \left[ #1 \right]$}} %期待値
\def\Var#1{\mbox{${\rm V} \left[ #1 \right]$}} %分散
\def\Cov#1#2{\mbox{${\rm Cov} \left[ #1,\ #2 \right]$}} %共分散
\def\exp#1{\mbox{${\rm exp} \left( #1 \right)$}} %指数関数
\def\prob#1{\mbox{${\rm Pr} \left( #1 \right)$}} %確率
\def\cprob#1#2{\mbox{${\rm Pr} \left( #1 | #2 \right)$}} %条件付確率

\begin{document}

\title{\Huge ゼミ資料\\待ち行列理論と板の動きへの応用}
\author{\Large 学籍番号：201311324\\百合川尚学}
\maketitle

\section{待ち行列理論の導入}
	興味があること
	\begin{itemize}
		\item 観測を始めて$t$時間経過した後のシステム内の客数．
    	\item システムにいる客数が初期状態から$0$になるまでの時間の分布．
    	\item システムを最良気配に見立てると，最良気配にかかる注文の数量の変化の分布
    	を考えることになる．
	\end{itemize}
	\begin{picture}(100,100)
    	%待ち行列の系内モデル図
    	\put( 80, 50){\framebox(20,20){客}}
        \put( 100, 60){\vector(1,0){40}}
        \put( 110, 30){\dashbox(40,20){到着}}
        \put( 160, 30){\framebox(165,60)[t]{\Large システム}}
        \put( 160, 30){\framebox(165,60)[br]{サーバー}}
        \put( 170, 50){\framebox(20,20){客}}
        \put( 190, 50){\framebox(20,20){客}}
        \put( 210, 50){\framebox(20,20){客}}
        \put( 230, 50){\framebox(20,20){客}}
        \put( 250, 50){\framebox(20,20){客}}
        \put( 300, 60){\circle{200}}
        \put( 290, 50){\framebox(20,20){客}}
        \put( 310, 60){\vector(1,0){40}}
        \put( 335, 30){\dashbox(40,20){退場}}
        
        \put( 60, -90){\framebox(40,20){売り指値}}
        \put( 100, -80){\vector(1,0){40}}
        \put( 170, -90){\framebox(80,20){最良売り気配数量}}
        \put( 170, -120){\framebox(40,20){買い成行}}
        \put( 210, -110){\vector(1,0){30}}
        \put( 250, -150){\vector(0,1){130}}
        \put( 230, -15){\dashbox(40,20){価格}}
        \put( 310, -90){\framebox(40,20){売り成行}}
        \put( 310, -80){\vector(-1,0){30}}
        \put( 250, -120){\framebox(80,20){最良買い気配数量}}
        \put( 420, -120){\framebox(45,20){買い指値}}
        \put( 420, -110){\vector(-1,0){40}}
	\end{picture}

\newpage
\section{$References$}
	参考文献：
    \begin{enumerate}
    	\item Suzuki, Queueing, Shokabo, 1972, pp. 20-65.
        \item Endo, Zuo, Kishimoto, 
        Modelling Intra-day Stock Price Changes In Terms of
        a Continuous Double Auction System, 
        The Japan Society for Industrial and Applied Mathematics, 
        Vol.16 , No.3, 2006, pp.305-316.
        \item Li, Hui, Endo, Kishimoto, A Quantitative Model for Intraday Stock Price
         Changes Based on Order Flows, 
         J Syst Sci Complex, 2014, 27: 208-224.
    \end{enumerate}
    上記文献$2$と$3$に従い，板は最良気配のみを考え，板が動くことは最良気配値が動くこととする．\\\\
    \begin{description}
    	\item[注文の種類]\mbox{}\\
     	上記文献$2$と$3$に従い，次の4種類のみを考える．
    	\begin{itemize}
    		\item 指値買い/売り注文　(最良買い/売り気配の数量を増加する．)
        	\item 成行買い/売り注文　(最良買い/売り気配の数量を減少する．)
    	\end{itemize}
     \end{description}
    
\newpage
\section{基礎理論まとめ \qquad $Poisson\quad Arrival$}
    \begin{screen}
    或るシステムがあり，そのシステムには或る確率分布に従った時間間隔で客が訪れ，
    或る確率分布に従った時間だけサービスを受け退場する．到着の時間間隔およびサービス時間
    は客ごとに独立であると考える．
    \end{screen}
    \begin{description}
    	\item[到着時間の分布について]\mbox{}\\
    	観測開始時刻を$T_0$，始めの客が到着する時刻を$T_1$，$2$番目の客が到着する時刻を$T_2$，
    	$\cdots$ ，として系列$\{T_n\}_{n=0}^{\infty}$を得る．各時間間隔$T_n - T_{n-1}, n=0,1,2,\cdots$
    	はどの二つも互いに独立で同一な確率分布(到着分布)に従う．
    \end{description}
    \begin{description}
    	\item[到着分布の例：$k-$アーラン分布\ $(k-Erlang\ distribution)$]\mbox{}\\
    		分布関数を$E_k(x),\ -\infty < x < \infty$と表すと，
    		\begin{equation}
    			E_k(x) \equiv
        		\begin{cases}
        			1 - \exp{-\lambda k x} \left( 1 + \frac{\lambda k x}{1!} + \cdots + \frac{(\lambda k x)^{k-1}}{(k-1)!} \right) & \text{$x \geq 0$}\\
    				0 & \text{$x < 0$}
        		\end{cases}
    		\end{equation}
            平均 $\frac{1}{\lambda}$，分散 $\frac{1}{k\lambda^2}$，
            特性関数 $\phi_{E_k}(t) = \left( 1 - \frac{it}{\lambda k} \right)^{-k}$($i$:虚数単位)．(付録$1$参照)
    \end{description}
    到着分布の平均の逆数を到着率と云う．これは単位時間当たりの平均到着客数を表す．(上の例だと到着率は$\lambda$．)

\newpage
\section{基礎理論まとめ \qquad $Poisson\quad Arrival$}
	\begin{screen}
    	\begin{Prop}
        	$k-$アーラン分布の到着率を$\lambda$とする．ここで一定到着分布を
            \begin{eqnarray}
            	F(x) \equiv
                \begin{cases}
                	1 & \text{$x \geq \frac{1}{\lambda}$}\\
                    0 & \text{$x < \frac{1}{\lambda}$}
                \end{cases}
            \end{eqnarray}
            とおく．$k-$アーラン分布は$k \rightarrow \infty$で一定到着分布に分布収束する．
        \end{Prop}
    \end{screen}
    \begin{Proof}
    	$k-$アーラン分布の特性関数を$\phi_{E_k}(t)$，一定到着の分布の特性関数を$\phi_{F}(t)$と表す．
        $\phi_{E_k}(t)$が$\phi_{F}(t)$に各点収束すれば，$Glivenko$の定理により定理が示される．
        \begin{eqnarray}
        	\lim_{k \to \infty} \phi_{E_k}(t) = \lim_{k \to \infty} \left( 1 - \frac{it}{\lambda k} \right)^{-k} 
            = \exp{\frac{it}{\lambda}}.
        \end{eqnarray}
        一方，一定到着の特性関数は，一定到着分布が離散分布であるから，
        \begin{eqnarray}
        	\int_{-\infty}^{\infty} \exp{itx} dF(x) = \exp{it\frac{1}{\lambda}} F(\frac{1}{\lambda}) = \exp{\frac{it}{\lambda}}.
        \end{eqnarray}
        従って定理は証明された．\qed
    \end{Proof}

\newpage
\section{基礎理論まとめ \qquad $Poisson\quad Arrival$}
	$k-$アーラン分布の$k = 1$のとき，客の到着時間間隔は到着率$\lambda$の指数分布$E_X(\lambda)$に従う．指数分布は無記憶性を有つ:
    \begin{eqnarray}
    	&X(\omega) \sim E_X(\lambda),\\
    	&\cprob{X \leq \tau+t}{X > \tau} = \frac{\exp{\lambda \tau} - \exp{\lambda (\tau+t)}}{\exp{\lambda (\tau)}} = \prob{X \leq t}. \quad (\tau,t > 0)
    \end{eqnarray}
    この性質から，次の定理が成り立つ．
    \begin{screen}
    	\begin{Prop}
    		到着時間間隔が独立に同一な指数分布に従うとき，任意の時間区間$(\tau, \tau + t]$に到着する客数は同一な$Poisson$過程に従い，
    		重ならない時間間隔では独立となる．また逆も成り立つ．
        \end{Prop}
    \end{screen}
    \begin{Proof}
    	\begin{description}
        	\begin{picture}(100,80)
            	%数直線を描く
    			\put( -20, 40){\vector(1,0){400}}
                \put( -10, 30){\line(0,1){20}}
                \put( -12, 60){{0}}
                \put( 0, 32){\vector(0,1){5}}
                \put( 14, 32){\vector(0,1){5}}
                \put( 36, 32){\vector(0,1){5}}
                \put( 42, 32){\vector(0,1){5}}
                \put( 79, 32){\vector(0,1){5}}
                \put( 120, 32){\vector(0,1){5}}
                \put( 120, 50){\dashbox(10,10){\Large \tau}}
                \put( 125, 40){\line(0,1){8}}
                \put( 142, 32){\vector(0,1){5}}
                \put( 166, 32){\vector(0,1){5}}
                \put( 200, 32){\vector(0,1){5}}
                \put( 210, 32){\vector(0,1){5}}
                \put( 214, 32){\vector(0,1){5}}
                \put( 232, 32){\vector(0,1){5}}
                \put( 225, 50){\dashbox(30,10){\Large \tau + t}}
                \put( 240, 40){\line(0,1){8}}
                \put( 240, 32){\vector(0,1){5}}
                \put( 280, 32){\vector(0,1){5}}
                \put( 298, 32){\vector(0,1){5}}
                \put( 314, 32){\vector(0,1){5}}
                \put( 316, 32){\vector(0,1){5}}
                \put( 326, 32){\vector(0,1){5}}
                \put( 350, 32){\vector(0,1){5}}
			\end{picture}
    		\item[(1)任意の時間区間に到着する客数は同一な$Poisson$過程に従う]\mbox{}\\
            	
        		観測開始時点を$0$として，時間$(\tau,\tau+t]$の間にシステムに到着する客数の総数を$N(\tau,\tau+t]$と表す．
            	$G_n(x)\ (x \geq 0)$を，$Gamma$分布$G_A(n, \frac{1}{\lambda})$の分布関数であるとする．
	    		\begin{eqnarray}
                	\prob{N(\tau,\tau+t] = n} &=& \prob{N(\tau,\tau+t] \geq n} - \prob{N(\tau,\tau+t] \geq n+1}\\
                	&=& \prob{G_n(x) \leq t} - \prob{G_{n+1}(x) \leq t} \qquad (\mbox{付録2参照})\\
                	&=& \int_{0}^{t} \frac{\lambda^n}{(n-1)!}x^{n-1}\exp{-\lambda x} dx - \int_{0}^{t} \frac{\lambda^{n+1}}{n!}x^n\exp{-\lambda x} dx \\
                	&=& \left[ \frac{\lambda^n}{n!}x^n\exp{-\lambda x} \right]_{x=0}^{x=t} + \int_{0}^{t} \frac{\lambda^{n+1}}{n!}x^n\exp{-\lambda x} dx - \int_{0}^{t} \frac{\lambda^{n+1}}{n!}x^n\exp{-\lambda x} dx \\
                	&=& \frac{\lambda^n}{n!}t^n\exp{-\lambda t}.
    			\end{eqnarray}
                即ち，到着客数は時間間隔のみに依存する．
            \item[(2)重ならない時間間隔では独立となる]\mbox{}\\
            	任意の重ならない時間間隔$(\tau_1,\tau_1+t_1], (\tau_2,\tau_2+t_2]$に対して，到着客数をそれぞれ$n_1, n_2$と表すと，同時確率は以下のように表される:
                \begin{eqnarray}
                	&&\prob{N(\tau_1,\tau_1+t_1]=n_1, N(\tau_2,\tau_2+t_2]=n_2} \\
                    &&\quad= \prob{N(\tau_1,\tau_1+t_1]=n_1}\cprob{N(\tau_2,\tau_2+t_2]=n_2}{N(\tau_1,\tau_1+t_1]=n_1} \\
                    &&\quad= \left\{ \prob{G_n_1(t_1) \leq t_1} - \prob{G_{n_1+1}(t_1) \leq t_1} \right\} \left\{ \prob{G_n_2(t_2) \leq t_2} - \prob{G_{n_2+1}(t_2) \leq t_2} \right\} \\
                    &&\quad= \prob{N(\tau_1,\tau_1+t_1]=n_1} \prob{N(\tau_2,\tau_2+t_2]=n_2}.
                \end{eqnarray}
            \item[(3)逆を示す]\mbox{}\\
            	任意の時間区間$(\tau, \tau + t]$に到着する客数は同一な$Poisson$過程に従い，重ならない時間間隔では独立となると仮定の下で，
                時間間隔を表す確率変数$\{T_n - T_{n-1}\}_{n=1}^{\infty}$の分布を導出する．最後に到着が観測されてから次の到着が観測されるまでの時間の分布は，
                \begin{eqnarray}
                	\prob{T_n - T_{n-1} \leq t} &=& 1 - \int_{0}^{\infty} \cprob{N(\tau, \tau+t] = 0}{N(0, \tau] = n-1} d\prob{N(0, \tau] = n-1} \\
                    &=& 1 - \prob{N(0, t] = 0} \int_{0}^{\infty} d\prob{N(0, \tau] = n-1} \\
                    &=& 1 - \exp{-\lambda t}.
                \end{eqnarray}
    	\end{description}
        \qed
    \end{Proof}
    一度にサービスを受ける人数を$1$として，サービス時間も到着時間間隔と同様に指数分布に従う下での待ち行列を$M/M/1 \quad (Kendall's\ notation)$と表記する．\\
    \[
    	\mbox{到着時間間隔の分布} / \mbox{サービス時間の分布} / \mbox{サーバー数}.
    \]

\newpage
\section{基礎理論まとめ \qquad $Chapman-Kolmogorov\quad Equation$}
	本稿では$M/M/1$のみを考える．\\
    \begin{description}
		\item[システム内の状態:]\mbox{}\\
        	観測時点$t$にて，系内客数が$j$であるとする．システム内の状態をこの客数$j$で評価する．\\
            客数は，サービスを待っている人とサービスを受けている人の和である．\\
            \mbox{}
        \item[マルコフ性\　$(Markov\ property)$:]\mbox{}\\
    		前節で見てきたとおり，系内客数の変化は，
    		\begin{itemize}
    			\item 客は或る一定の到着率を有つ指数分布に従ってやってくる．どの二人の客も互いの到着時間に影響を与えることはない．
        		\item 或る一定の平均時間を有つ指数分布に従って客は一人ずつサービスを受け，終わったら退場する．どの二人の客も互いのサービス時間に影響を与えることはない．
    		\end{itemize}
    		の2つの事象に因る．また客の到着時間間隔とサービス時間は独立に動く．任意に観測時刻の始点を置くとき，始点を置く直前までシステムに向かっていた途中である客，
    		またはサービスを受けている最中であった客もいるかもしれないが，指数分布の無記憶性により，観測始点以降に観測する到着時間，サービス時間の分布は観測始点に影響されない．
    		従って，現時点から次に起こる系内客数の変化は，現状のみに依存し過去の影響を受けない．これをマルコフ性と云う．\\
            \mbox{}
    \end{description}
    観測始点を$0$とし，時点$0$の系内客数を$i$と表す．この下で，観測時点$t \geq 0$における系内客数$Q(t)$の分布を
    \begin{eqnarray}
    	P_{ij}(t) &=& \cprob{Q(t) = j}{Q(0) = i} \\
        P_{ij}(0) &=& 
        \begin{cases}
        	1 & \text{$i = j$} \\
            0 & \text{$i \neq j$}
        \end{cases}
    \end{eqnarray}
    と表記する．

\newpage
\section{基礎理論まとめ \qquad $Chapman-Kolmogorov\quad Equation$}
	ここで，到着時間間隔の分布を平均$\frac{1}{\lambda}$の指数分布$E_X(\lambda)$，サービス時間の分布を$E_X(\mu)$と設定する．
    状態推移のグラフは以下のように見られる．
    \begin{picture}
    	
    \end{picture}
    最後に状態変化した時点から見て，平均$\frac{1}{\lambda}$時間で次に客が到着し状態が上に変化するか，平均$\frac{1}{\mu}$時間で次に客が退場し状態が下に変化する．
    また到着と退場は独立に動く．従って上グラフの時間軸に平行な線分は全て，その長さは，次の状態変化の方向によって指数分布$E_X(\lambda)$か$E_X(\mu)$に完全に従う確率変数の
    実現値である．従って，任意に観測始点をおく場合，観測開始から状態変化までの時間の分布は観測始点に影響されない．\\
    観測時点$t$から時間$h$だけ経過した後の系内状態を$j$とする．このとき，$P_{ij}(t)$の無記憶性から以下の等式が成立する．
    \begin{eqnarray}
    	P_{ij}(t+h) &=& \sum_{k=0}^{\infty} \cprob{Q(t+h) = j}{Q(t) = k, Q(0) = i}\cprob{Q(t) = k}{Q(0) = i} \\
        &=& \sum_{k=0}^{\infty} \cprob{Q(t+h) = j}{Q(t) = k}\cprob{Q(t) = k}{Q(0) = i} \\
        &=& \sum_{k=0}^{\infty} \cprob{Q(h) = j}{Q(0) = k}\cprob{Q(t) = k}{Q(0) = i} \\
        &=& \sum_{k=0}^{\infty} P_{ik}(t)P_{kj}(h).
    \end{eqnarray}
    これが $Chapman-Kolmogorov$の方程式である．
    \begin{screen}
    	\begin{description}
        	\item[$Chapman-Kolmogorov$の方程式]\mbox{}\\
            	任意の時間間隔$t,h > 0$と状態$i,j \geq 0$に対して，
                \[
            		P_{ij}(t+h) = \sum_{k=0}^{\infty} P_{ik}(t)P_{kj}(h).
                \]
        \end{description}
    \end{screen}

\newpage
\section{基礎理論まとめ \qquad $Foward\ Equations\ of\ Kolmogorov$}


%付録
\scriptsize
\newpage
\section{付録1}
	\begin{description}
    	\item[到着分布の例：$k-$アーラン分布\ $(k-Erlang\ distribution)$]\mbox{}\\
    		\begin{equation}
    			E_k(x) \equiv
        		\begin{cases}
        			1 - \exp{-\lambda k x} \left( 1 + \frac{\lambda k x}{1!} + \cdots + \frac{(\lambda k x)^{k-1}}{(k-1)!} \right) & \text{$x \geq 0$}\\
    				0 & \text{$x < 0$}
        		\end{cases}
    		\end{equation}
        平均，分散，特性関数を計算する．
        密度関数
        \begin{eqnarray}
            f(x) &=& E_k'(x) \\&=& 
            \begin{cases}
        			\lambda k \exp{-\lambda k x} \left( 1 + \frac{\lambda k x}{1!} + \cdots + \frac{(\lambda k x)^{k-1}}{(k-1)!} \right)
                    - \lambda k \exp{-\lambda k x} \left( 1 + \frac{\lambda k x}{1!} + \cdots + \frac{(\lambda k x)^{k-2}}{(k-2)!} \right) & \text{$x \geq 0$}\\
    				0 & \text{$x < 0$}
        	\end{cases} 
            \\&=&
            \begin{cases}
        			\lambda k \exp{-\lambda k x} \frac{(\lambda k x)^{k-1}}{(k-1)!} & \text{$x \geq 0$}\\
    				0 & \text{$x < 0$}
        	\end{cases}.
        \end{eqnarray}
        これは$Gamma$分布\ $G_A(k, \frac{1}{\lambda k})$の密度関数である．従って一般の
        $Gamma$分布\ $G_A(\alpha, \beta)$について平均，分散，特性関数を計算する方が楽である．\\
        特性関数 : 確率変数 $X \sim G_A(\alpha, \beta)$ について，
        \begin{eqnarray}
			\phi(t) &=& E[e^{itX}] \\
			&=& \int_{0}^{\infty} e^{itx} \frac{1}{\Gamma(\alpha)\beta^\alpha} x^{\alpha-1} e^{-\frac{x}{\beta}} dx \\
			&=& \int_{0}^{\infty} \frac{1}{\Gamma(\alpha)\beta^\alpha} x^{\alpha-1} e^{-(\frac{1}{\beta}-it)x} dx	\\
			&=& \lim_{R \to \infty} \int_{0}^{R} \frac{1}{\Gamma(\alpha)\beta^\alpha} x^{\alpha-1} e^{-(\frac{1}{\beta}-it)x} dx \\
			&=& \lim_{R \to \infty} \frac{1}{\Gamma(\alpha)\beta^\alpha} (\frac{\beta}{1-i \beta t})^\alpha \int_{0}^{\frac{R}{\beta}-itR} z^{\alpha-1} e^{-z} dz.
		\end{eqnarray}
        ここで
		\[
			\int_{0}^{\frac{R}{\beta}-itR} z^{\alpha-1} e^{-z} dz
		\]
		について複素積分を考える．
        積分路を$\Gamma \equiv \Gamma_1 \cup \Gamma_2 \cup \Gamma_3$として，被積分関数が$\mathbb{C}$の整関数であることから$\Gamma$および内部領域に孤立特異点は存在しない．
		積分の向きは左回りとして，$Cauchy$の積分定理が成り立つので
		\[
			\oint_{\Gamma} z^{\alpha-1} e^{-z} dz = 0
		\]
		が成り立つ．
		$\Gamma_2$上の積分は
		\begin{eqnarray}
			\left|\int_{\Gamma_2} z^{\alpha-1} e^{-z} dz\right| 
			&=& \left|\int_{-tR}^{0} (\frac{R}{\beta}+iy})^{\alpha-1} e^{-\frac{R}{\beta}-iy} i dy\right| \\
			&\leq& \int_{-tR}^{0} (\frac{R}{\beta}+|y|})^{\alpha-1} e^{-\frac{R}{\beta}} dy.
		\end{eqnarray}
		任意の$\epsilon > 0$に対し$t$について定まる或る$R_1(t)$が存在して，$R > R_1(t)$ならば
		\[
			\int_{-tR}^{0} (\frac{R}{\beta}+|y|})^{\alpha-1} e^{-\frac{R}{\beta}} dy < \epsilon
		\]
		が成り立つ．$\Gamma_3$上の積分は
		\[
			\int_{\frac{R}{\beta}}^{0} z^{\alpha-1} e^{-z} dz = -\int_{0}^{\frac{R}{\beta}} z^{\alpha-1} e^{-z} dz.
		\]
		これも広義積分は収束するので，任意の$\epsilon > 0$に対し或る$R_2$が存在して，$R > R_2$ならば
		\[
			\Gamma(\alpha)-\epsilon < \int_{0}^{\lambda R} z^{\alpha-1} e^{-z} dx \leq \Gamma(\alpha).
		\]
		従って，$R > max\{R_1(t), R_2\}$と置いて
		\begin{eqnarray}
			\left|\int_{\Gamma_1} z^{\alpha-1} e^{-z} dz -  \Gamma(\alpha)\right|
			&=& \left|-\int_{\Gamma_2} z^{\alpha-1} e^{-z} dz
		    	   -\int_{\Gamma_3} z^{\alpha-1} e^{-z} dz - \Gamma(\alpha)\right| < 2 \epsilon.
		\end{eqnarray}
		$\epsilon$は任意であるから
		\[
			\lim_{R \to \infty} \frac{1}{\Gamma(\alpha)\beta^\alpha} (\frac{\beta}{1-i \beta t})^\alpha \int_{0}^{\frac{R}{\beta}-itR} z^{\alpha-1} e^{-z} dz 
			= (\frac{1}{1-i \beta t})^\alpha
		\]
		が成り立つ．$t \leq 0$の場合も同じ結論となる．
        \qed
    \end{description}
    
\newpage
\section{付録2}
	確率変数$X(\omega),Y(\omega)$を，それぞれ$Gamma$分布$G_A(n-1, \frac{1}{\lambda})$，指数分布$E_X(\lambda)$に独立に従うとする．
    このとき和$Z(\omega) = X(\omega) + Y(\omega)$の分布を求める．
    \begin{eqnarray}
    	\prob{Z \leq z} &=& \underset{x,y \geq 0, x + y \leq z}{\iint} \frac{\lambda^{n-1}}{(n-2)!}x^{n-2}\exp{-\lambda x} \lambda \exp{-\lambda y} dxdy \\
        &=& \int_{0}^{z} \frac{\lambda^{n-1}}{(n-2)!}x^{n-2}\exp{-\lambda x} \left[ 1 - \exp{-\lambda y} \right]_{y=0}^{y = z - x} dx \\
        &=& \int_{0}^{z} \frac{\lambda^{n-1}}{(n-2)!}x^{n-2}(\exp{-\lambda x} - \exp{-\lambda z}) dx \\
        &=& \left[ \frac{\lambda^{n-1}}{(n-1)!}x^{n-1}(\exp{-\lambda x} - \exp{-\lambda z}) \right]_{x=0}^{x=z} + \int_{0}^{z} \frac{\lambda^n}{(n-1)!}x^{n-1}\exp{-\lambda x} dx \\
        &=& \int_{0}^{z} \frac{\lambda^n}{(n-1)!}x^{n-1}\exp{-\lambda x} dx.
    \end{eqnarray}
    よって$Z$が$Gamma$分布$G_A(n, \frac{1}{\lambda})$に従っていると示された．$G_A(1, \frac{1}{\lambda}) = E_X(\lambda)$であることから，独立に同一の指数分布に従う$n$個の確率変数の
    和の分布は$G_A(n, \frac{1}{\lambda})$であることが帰納的に示される．
\end{document}
